"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.findDelistedPerpMarketsAndOracles = exports.capitalize = void 0;
const types_1 = require("../types");
function capitalize(value) {
    return value[0].toUpperCase() + value.slice(1);
}
exports.capitalize = capitalize;
function findDelistedPerpMarketsAndOracles(perpMarkets, spotMarkets) {
    const delistedPerpMarketIndexes = [];
    const delistedOracles = [];
    for (const perpMarket of perpMarkets) {
        if (!perpMarket.data) {
            continue;
        }
        if ((0, types_1.isVariant)(perpMarket.data.status, 'delisted')) {
            delistedPerpMarketIndexes.push(perpMarket.data.marketIndex);
            delistedOracles.push(perpMarket.data.amm.oracle);
        }
    }
    // make sure oracle isn't used by spot market
    const filteredDelistedOracles = [];
    for (const delistedOracle of delistedOracles) {
        for (const spotMarket of spotMarkets) {
            if (!spotMarket.data) {
                continue;
            }
            if (spotMarket.data.oracle.equals(delistedOracle)) {
                break;
            }
        }
        filteredDelistedOracles.push(delistedOracle);
    }
    return {
        perpMarketIndexes: delistedPerpMarketIndexes,
        oracles: filteredDelistedOracles,
    };
}
exports.findDelistedPerpMarketsAndOracles = findDelistedPerpMarketsAndOracles;
